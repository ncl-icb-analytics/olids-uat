test_suites:
  
  all:
    description: "Run all OLIDS data validation tests"
    categories:
      - referential_integrity
      - concept_mapping
      - person_patterns
      - null_columns
      - empty_tables
      - column_completeness
    
  referential_integrity:
    description: "Validate all foreign key relationships in OLIDS database"
    tests:
      - referential_integrity
      
  concept_mapping:
    description: "Validate concept mapping chains and terminology"
    tests:
      - concept_mapping
      
  person_patterns:
    description: "Validate person/patient data patterns and business rules"
    tests:
      - person_patterns
      
  null_columns:
    description: "Identify columns with 100% NULL values across all tables"
    tests:
      - null_columns
      
  empty_tables:
    description: "Identify tables with zero rows"
    tests:
      - empty_tables
      
  column_completeness:
    description: "Check completeness rates for critical columns"
    tests:
      - column_completeness

# Individual test configurations
test_config:
  
  # Data Quality Tests
  null_columns:
    description: "Identify columns with 100% NULL values across all tables"
    timeout: 300
    priority: high
    test_count: 710  # Based on actual test output showing 710 columns checked
    
  empty_tables:
    description: "Identify tables with zero rows"
    timeout: 180
    priority: high
    test_count: 28   # Based on actual test output showing 28 tables checked
    
  column_completeness:
    description: "Check completeness rates for critical columns"
    timeout: 300
    priority: high
    test_count: 6    # Based on actual test output showing 6 completeness checks
    
  # Referential Integrity Tests  
  referential_integrity:
    description: "Validates all 85 foreign key relationships in OLIDS database"
    timeout: 600
    priority: critical
    relationships_count: 85
    
  # Concept Mapping Tests
  concept_mapping:
    description: "Validates concept ID mappings through CONCEPT_MAP to CONCEPT chains"
    timeout: 240
    priority: critical
    concept_columns: 28
    
  # Business Rules Tests
  person_patterns:
    description: "Validates person/patient data patterns and business rules"
    timeout: 300
    priority: critical
    pattern_count: 13

# Failure threshold configurations (as percentages)
failure_thresholds:
  
  # Default thresholds by category
  data_quality: 0.0        # No failures allowed for data quality tests
  referential_integrity: 0.0  # No violations allowed for referential integrity
  concept_mapping: 5.0     # Allow up to 5% concept mapping failures
  person_patterns: 2.0     # Allow up to 2% business rule violations
  
  # Test-specific threshold overrides (overrides category defaults)
  null_columns: 0.0        # No all-null columns allowed
  empty_tables: 0.0        # No empty tables allowed
  column_completeness: 5.0 # Allow up to 5% missing values for completeness checks
  
  # Environment-specific thresholds (can be overridden in environment configs)
  environments:
    dev:
      data_quality: 10.0   # More lenient thresholds for dev environment
      concept_mapping: 15.0
      person_patterns: 10.0
    uat:
      data_quality: 2.0    # Moderate thresholds for UAT
      concept_mapping: 8.0
      person_patterns: 5.0
    prod:
      data_quality: 0.0    # Strict thresholds for production
      concept_mapping: 1.0
      person_patterns: 1.0
  
  # Individual completeness thresholds (used by column_completeness test)
  completeness_rules:
    "PATIENT.nhs_number_hash": 95.0
    "PATIENT.birth_year": 98.0
    "PATIENT.birth_month": 98.0
    "ENCOUNTER.patient_id": 100.0
    "OBSERVATION.patient_id": 100.0
    "PERSON.id": 100.0